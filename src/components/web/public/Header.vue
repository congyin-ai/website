<template>
  <div
    class="header"
    :class="{ header_show: headerShow, shadow: headerShadowActive }"
  >
    <div class="header_container">
      <div class="header_content">
        <div class="logo">
          <router-link to="/">
            <img
              :src="logo_img[0].path"
              alt="logo"
              v-if="headerLogoShow === true"
            />
            <img :src="logo_img[1].path" alt="logo" v-else />
          </router-link>
        </div>
        <div class="menu-wrapper">
          <div class="line"></div>
          <el-menu
            :default-active="activeIndex2"
            class="menu-item"
            mode="horizontal"
            text-color="#000"
            :router="true"
          >
            <el-menu-item index="/">{{ $t("header.home") }}</el-menu-item>
            <el-submenu index="/research/products">
              <template slot="title">{{
                $t("header.research.title")
              }}</template>
              <el-menu-item index="/research/academic">{{
                $t("header.research.sub1")
              }}</el-menu-item>
              <el-menu-item index="/research/products">{{
                $t("header.research.sub2")
              }}</el-menu-item>
              <el-menu-item index="/research/experience">{{
                $t("header.research.sub3")
              }}</el-menu-item>
            </el-submenu>
            <el-menu-item index="/news">{{ $t("header.news") }}</el-menu-item>
            <el-submenu index="/us/cominfo">
              <template slot="title">{{ $t("header.us.title") }}</template>
              <el-menu-item index="/us/cominfo">{{
                $t("header.us.sub1")
              }}</el-menu-item>
              <el-menu-item index="/us/partners">{{
                $t("header.us.sub2")
              }}</el-menu-item>
              <el-menu-item index="/us/joinus">{{
                $t("header.us.sub3")
              }}</el-menu-item>
            </el-submenu>
            <el-menu-item index="/login" style="float: right" v-if="userData==null"
              ><svg
                t="1695479955878"
                class="icon"
                viewBox="0 0 1024 1024"
                version="1.1"
                xmlns="http://www.w3.org/2000/svg"
                p-id="5604"
                width="32"
                height="32"
              >
                <path
                  d="M960.853333 903.816533a463.633067 463.633067 0 0 0-11.264-39.185066c-1.536-4.539733-3.413333-8.942933-5.051733-13.448534a484.078933 484.078933 0 0 0-9.557333-24.4736c-2.2528-5.188267-4.881067-10.274133-7.338667-15.394133-3.413333-7.099733-6.8608-14.165333-10.6496-21.0944-2.901333-5.3248-6.075733-10.513067-9.181867-15.701333-2.423467-4.061867-4.573867-8.226133-7.133866-12.219734-1.604267-2.4576-3.413333-4.778667-5.0176-7.202133-1.501867-2.218667-2.730667-4.608-4.266667-6.792533-0.4096-0.6144-1.058133-0.887467-1.501867-1.4336a461.482667 461.482667 0 0 0-90.385066-96.768c-13.5168-10.786133-27.7504-20.48-42.257067-29.5936-0.477867-0.341333-0.7168-0.8192-1.194667-1.1264-3.6864-2.286933-7.509333-4.3008-11.264-6.485334-4.266667-2.491733-8.4992-5.051733-12.868266-7.441066-6.826667-3.6864-13.789867-7.099733-20.753067-10.478934-3.618133-1.7408-7.202133-3.618133-10.8544-5.290666a449.194667 449.194667 0 0 0-31.607467-12.731734c-0.7168-0.273067-1.365333-0.6144-2.082133-0.8192-3.140267-1.1264-6.417067-1.911467-9.557333-2.935466-4.164267-1.399467-8.328533-2.833067-12.561067-4.096a259.9936 259.9936 0 0 0 129.194667-225.450667 260.061867 260.061867 0 0 0-76.629334-185.002667 259.9936 259.9936 0 0 0-185.002666-76.629333H512h-0.034133a259.857067 259.857067 0 0 0-185.002667 76.629333 259.925333 259.925333 0 0 0-76.629333 185.002667 259.584 259.584 0 0 0 76.629333 185.002667c15.906133 15.940267 33.655467 29.2864 52.565333 40.448-4.266667 1.262933-8.430933 2.730667-12.663466 4.096-3.140267 1.058133-6.3488 1.8432-9.489067 2.935466-0.7168 0.238933-1.365333 0.580267-2.048 0.8192-10.683733 3.822933-21.265067 8.0896-31.675733 12.765867-3.584 1.604267-7.0656 3.4816-10.615467 5.154133-7.099733 3.413333-14.165333 6.826667-21.0944 10.615467-4.266667 2.321067-8.3968 4.8128-12.561067 7.2704-3.822933 2.218667-7.748267 4.266667-11.502933 6.621867-0.512 0.3072-0.750933 0.8192-1.2288 1.160533-14.506667 9.147733-28.706133 18.807467-42.222933 29.559467a459.6736 459.6736 0 0 0-90.385067 96.768c-0.443733 0.546133-1.092267 0.8192-1.501867 1.4336-1.536 2.184533-2.7648 4.573867-4.266666 6.792533-1.604267 2.423467-3.447467 4.744533-5.0176 7.202133-2.56 3.9936-4.7104 8.157867-7.133867 12.219734-3.106133 5.188267-6.280533 10.376533-9.181867 15.701333-3.7888 6.929067-7.202133 13.994667-10.6496 21.0944-2.4576 5.12-5.051733 10.205867-7.338666 15.394133-3.515733 8.021333-6.519467 16.247467-9.557334 24.4736-1.672533 4.5056-3.549867 8.9088-5.051733 13.448534-4.3008 12.868267-8.0896 25.941333-11.264 39.185066-3.072 12.970667 2.594133 25.770667 13.073067 32.802134a31.3344 31.3344 0 0 0 9.966933 4.608 30.9248 30.9248 0 0 0 34.030933-15.2576 30.446933 30.446933 0 0 0 3.345067-7.7824c2.833067-11.844267 6.178133-23.483733 10.0352-34.9184 0.6144-1.8432 1.399467-3.549867 2.013867-5.358934 3.447467-9.762133 7.133867-19.456 11.332266-28.945066 0.512-1.160533 1.1264-2.2528 1.6384-3.447467 4.7104-10.308267 9.728-20.48 15.291734-30.344533l0.068266-0.1024a402.773333 402.773333 0 0 1 19.694934-31.4368l0.136533-0.375467a397.4144 397.4144 0 0 1 116.599467-111.2064c0.136533-0.1024 0.3072-0.068267 0.443733-0.170667a397.824 397.824 0 0 1 94.993067-42.973866c2.7648-0.8192 5.495467-1.7408 8.2944-2.491734 5.7344-1.604267 11.5712-3.003733 17.373866-4.334933a367.8208 367.8208 0 0 1 47.342934-7.953067c3.8912-0.443733 7.7824-0.9216 11.6736-1.2288 10.410667-0.785067 20.8896-1.3312 31.505066-1.3312s21.060267 0.546133 31.505067 1.3312c3.8912 0.3072 7.816533 0.785067 11.707733 1.2288a361.3696 361.3696 0 0 1 47.240534 7.953067c5.870933 1.3312 11.707733 2.730667 17.5104 4.334933 2.696533 0.750933 5.358933 1.6384 8.021333 2.4576 33.348267 10.103467 65.365333 24.405333 95.197867 43.008 0.136533 0.1024 0.3072 0.068267 0.443733 0.170667a396.151467 396.151467 0 0 1 116.599467 111.2064c0.1024 0.136533 0.1024 0.273067 0.170666 0.375467 13.687467 19.7632 25.3952 40.5504 35.191467 62.1568l1.467733 3.037866c4.3008 9.659733 8.055467 19.592533 11.605334 29.5936 0.546133 1.604267 1.2288 3.106133 1.774933 4.7104 3.822933 11.4688 7.236267 23.176533 10.0352 35.0208a31.061333 31.061333 0 0 0 60.450133-14.336z m-249.275733-560.2304A199.850667 199.850667 0 0 1 512 543.197867a199.850667 199.850667 0 0 1-199.5776-199.611734A199.816533 199.816533 0 0 1 512 144.008533a199.816533 199.816533 0 0 1 199.5776 199.5776z"
                  fill="#272636"
                  p-id="5605"
                ></path></svg
            ></el-menu-item>
            <el-menu-item v-if="userData!=null" index="/profile" style="float: right">
              <span>
                <img
                  src="@/assets/img/index/app1.jpg"
                  style="
                    cursor: pointer;
                    border-radius: 20px;
                    height: 25px;
                    width: 25px;
                  "
              /></span>
              <span style="margin-right: 12%; margin-left: 3%">
                {{
                  userData.username.length > 3
                    ? userData.username.substring(0, 3) + "..."
                    : userData.username
                }}
              </span>
              <!-- 退出,鼠标移到到该位置变小手 -->
              <span
                style="cursor: pointer; font-size: 12px; color: #5356ad"
                @click="exitLogin"
              >
                退出
              </span>
            </el-menu-item>
            <!-- <div>index="/lang"</div> -->
            <el-submenu style="float: right" index="lang">
              <template slot="title"
                ><svg
                  t="1695479735009"
                  class="icon"
                  viewBox="0 0 1024 1024"
                  version="1.1"
                  xmlns="http://www.w3.org/2000/svg"
                  p-id="4074"
                  width="32"
                  height="32"
                >
                  <path
                    d="M848.805886 805.572222c70.998007-81.260745 109.779266-184.217628 109.779266-293.14448 0-119.204939-46.421262-231.277434-130.713041-315.569212C744.876861 113.862257 634.94103 67.61598 517.788843 66.213028c-1.924839-0.599657-10.290367-0.592494-12.227486 0.01535C388.878868 67.945485 279.434224 114.159016 196.73471 196.85853 113.863281 279.730982 67.630307 389.460106 66.095347 506.415818c-0.428765 1.64957-0.436952 8.601912-0.021489 10.226922 1.082658 117.628024 47.364751 228.058113 130.660852 311.354214 84.291778 84.291778 196.36325 130.713041 315.569212 130.713041 119.204939 0 231.277434-46.421262 315.569212-130.713041 6.139837-6.139837 12.054547-12.444427 17.789155-18.871813 0.50756-0.453325 1.001817-0.928139 1.471514-1.440815C847.750857 807.012014 848.295256 806.299793 848.805886 805.572222zM107.447151 532.043499l187.501418 0c1.322112 65.678862 9.253758 127.264499 22.505573 182.112688-61.690014 16.687054-100.819197 38.371936-121.076566 51.906184C144.30971 701.336206 111.676475 620.35687 107.447151 532.043499zM195.881272 259.408121c20.090571 13.556761 59.242266 35.461653 121.340579 52.260248-12.998035 54.127781-20.827351 114.778116-22.243607 179.432649L107.525945 491.101018C112.076588 403.731134 144.437623 323.612399 195.881272 259.408121zM917.081898 491.099994 729.628576 491.099994c-1.415232-64.630996-9.240455-125.260865-22.229281-179.37432 61.95505-16.693194 101.235682-38.444591 121.56673-52.020794C880.270505 323.860039 912.537396 403.866211 917.081898 491.099994zM688.677908 491.099994 532.167319 491.099994 532.167319 335.061149c52.209082-1.094938 97.103572-6.453992 135.272893-14.033621C680.000272 373.163955 687.286212 430.896844 688.677908 491.099994zM532.167319 294.115598 532.167319 109.918435c36.84107 10.398838 72.779583 49.205679 100.926644 110.015649 8.810666 19.035542 16.645099 39.641859 23.464411 61.521169C621.531626 288.227494 580.261687 293.062616 532.167319 294.115598zM491.223814 110.273523l0 183.805236c-47.504944-1.12666-88.378863-6.001691-123.120109-12.802584 6.807033-21.812795 14.623046-42.35976 23.409153-61.344137C419.351903 159.792333 454.809463 121.175827 491.223814 110.273523zM491.223814 335.040682l0 156.059312L335.928912 491.099994c1.391696-60.213383 8.679683-117.955482 21.243837-170.099073C395.008472 328.536548 439.487499 333.887416 491.223814 335.040682zM335.893096 532.043499l155.330718 0 0 158.667719c-51.609425 1.194198-96.019891 6.563486-133.821845 14.103206C344.576873 651.927913 337.193719 593.243349 335.893096 532.043499zM491.223814 731.672118l0 182.909843c-36.415374-10.902304-71.871911-49.51881-99.709933-109.659539-8.679683-18.752086-16.409738-39.034015-23.157419-60.551074C402.9964 737.645157 443.773106 732.820268 491.223814 731.672118zM532.167319 914.937049 532.167319 731.608673c47.904033 1.025353 89.103364 5.862521 124.116809 12.656251-6.755868 21.555945-14.497179 41.87369-23.190165 60.656475C604.946902 865.73137 569.008388 904.538211 532.167319 914.937049zM532.167319 690.660052 532.167319 532.043499l156.546406 0c-1.298576 61.096497-8.66024 119.68487-21.445428 172.502819C629.154233 697.013761 584.319096 691.710988 532.167319 690.660052zM729.659275 532.043499l187.501418 0c-4.221138 88.138386-36.732599 168.973436-88.620363 233.635131-20.469194-13.668301-59.635215-35.298947-121.30374-51.868321C720.43724 659.049101 728.33921 597.585237 729.659275 532.043499zM801.518906 228.742704c-18.329461 11.570523-52.309366 29.355585-104.858186 43.493583-19.295462-63.056128-46.110177-115.004267-78.06189-150.97655C689.00025 140.410913 751.833297 178.097234 801.518906 228.742704zM406.007991 121.259738c-31.905664 35.920094-58.690704 87.768973-77.979002 150.702304-52.40351-14.241352-86.370113-32.099069-104.581893-43.587728C273.076422 177.914062 335.777463 140.364865 406.007991 121.259738zM223.917816 796.963147c18.284435-11.535731 52.098565-29.230742 104.332207-43.335994 19.271926 62.60485 45.976124 114.186645 77.757968 149.968593C335.99952 884.550994 273.472442 847.181899 223.917816 796.963147zM618.59883 903.595746c31.801287-35.803437 58.517765-87.426165 77.792761-150.08218 51.984978 14.023388 85.972047 31.631418 104.533798 43.208081C751.3329 847.061149 688.718841 884.521319 618.59883 903.595746z"
                    fill="#2c2c2c"
                    p-id="4075"
                  ></path></svg
              ></template>
              <el-menu-item @click.native="changeType('zh')">{{
                $t("langs.zh")
              }}</el-menu-item>
              <el-menu-item @click.native="changeType('en')">{{
                $t("langs.en")
              }}</el-menu-item></el-submenu
            >
          </el-menu>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
import { mapState } from "vuex";
// import { logOut } from "@/api/auth";
export default {
  name: "Header",
  data() {
    return {
      // userData: {
      //   username:'12345',
      //   fullname:'123',
      // },
      userData:this.$store.state.auth.userData,
      lan: "",
      activeIndex: "1",
      activeIndex2: "1",
      navList: [
        {
          label: "首页",
          path: "/index",
        },
        {
          label: "研究",
          path: "/research",
          children: [
            {
              path: "/research/academic",
              name: "page1",
              label: "科研",
            },
            {
              path: "/research/product",
              name: "product",
              label: "产品",
            },
            {
              path: "/research/experiment",
              name: "experiment",
              label: "体验",
            },
          ],
        },
        {
          title: "新闻",
          path: "/news",
        },
        {
          title: "我们",
          path: "/us",
          children: [
            {
              path: "/us/cominfo",
              name: "cominfo",
              label: "公司简介",
            },
            {
              path: "/us/partner",
              name: "page1",
              label: "合作伙伴",
            },
            {
              path: "/us/joinus",
              name: "page1",
              label: "加入我们",
            },
          ],
        },
        // {
        //   title: '客户服务',
        //   path: '/customer'
        // },
        {
          title: "登录",
          path: "/login",
        },
      ],
      logo_img: [
        {
          path: require("../../../assets/img/index/logo.png"),
        },
        {
          path: require("../../../assets/img/index/logoColor.png"),
        },
      ],
    };
  },
  computed: {
    ...mapState([
      "headerShadowActive",
      "headerShow",
      "headerLogoShow",
      "navDarkActive",
    ]),
  },
  
  // beforeCreate() {
  //   console.log(this.$i18n.locale); //zh
  //   console.log(localStorage.getItem("locale")); //zh
  // },
  created() {
    // console.log(`output->this.userData`,this.userData)
    this.lan = this.$i18n.locale; //$i18n在实例刚创建完成就有了，这不是$el要在mounted时才能取到
    // this.userData = JSON.parse(sessionStorage.getItem("userData"))
    // console.log(this.$i18n.locale); //zh
    // console.log(localStorage.getItem("locale")); //zh
  },

  // mounted() {
  //   console.log(`output->data`,this.$store.state.auth.userData)
  //   console.log(`output->token`,this.$store.state.auth.token)
  // },
  methods: {
    changeType(type) {
      // 此处做了语言选择记录，存在localStorage中，这里的作用只有一个当我重新请求页面
      //的时候先取localStorage的记录值
      // var type='zh'
      // if(this.lan=='zh'){
      //   type='en'
      // }else if(this.lan=='en'){
      //   type='zh'
      // }
      localStorage.setItem("locale", type);
      this.$i18n.locale = type; // 修改页面需要显示的语言
      this.lan = this.$i18n.locale;
    },
    exitLogin() {
      this.$store.dispatch('LogOut').then((res) => {
        if (res.data.code == 200) {
          // sessionStorage.removeItem("Admin-Token");
          // sessionStorage.removeItem("userData");
          this.$message.success("退出成功");
          window.location.href = "/";
        }else{
          console.log("退出失败")
        }
      });
    },
  },
};
</script>


<style lang = "less" scoped>
@nav_active_color: #3370ff;
h2 {
  margin: 0;
}
.el-menu-item {
  border-radius: 8px 8px 8px 8px;
  font-size: 18px;
  font-weight: 400;
  font-family: "Microsoft YaHei";
  width: 100px !important;
}

.el-menu--horizontal > .el-menu-item.is-active {
  border-bottom: 2px solid #40fff600;
  color: #303133;
}

.el-submenu /deep/ .el-submenu__title {
  font-size: 18px;
  border-radius: 8px 8px 8px 8px;
}

.el-menu {
  background-color: rgba(0, 0, 0, 0);
  border: 0 !important;
  width: 100%;
}

.el-menu-item {
  border-radius: 10px;
  /* background-color: rgba(0, 0, 0, 0); */
}
.menu-item {
  background-color: rgba(0, 0, 0, 0);
}
.header_show {
  transform: translateY(-62px);
}
.a_text_dark {
  color: rgba(0, 0, 0, 0.8);
}
.header {
  width: 100%;
  height: 60px;
  background-color: rgba(255, 255, 255, 0);
  //backdrop-filter: blur(0);
  box-shadow: none;

  position: fixed;
  z-index: 999;
  transition: transform 0.2s ease;
  //color: rgba(255, 255, 255, 1) !important;
  //transition: all 0.3s ease;
  .header_container {
    height: 100%;
  }
}

.shadow {
  background-color: rgba(255, 255, 255, 0.7);
  backdrop-filter: blur(8px);
  box-shadow: 0 1px 8px 0 rgba(0, 0, 0, 0.1);
}

.header_content {
  display: flex;
  /* justify-content: space-between; */
  flex-direction: row;
  height: 100%;
  align-items: center;
  padding: 0 50px;
  margin: 0 auto;

  .logo {
    flex: 0 0 auto;

    img {
      padding-top: 15px;
      height: 100px;
    }
  }
}

.menu-wrapper {
  width: 100%;
}

/* .nav_text_white {
  color: rgba(255, 255, 255, 1);
}

.nav_text_dark {
  color: rgba(0, 0, 0, 0.8);
} */

@media only screen and (max-width: 991px) {
  .header_content {
    padding: 0 32px;
  }
}
</style>
<style>
.el-menu--popup {
  min-width: 150px !important;
  border-radius: 10px !important;
}
</style>